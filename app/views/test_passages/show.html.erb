<%= content_tag :h1, "Pass the test '#{@test_passage.test.title}'" %><br/>
Question
<%= @test_passage.current_question.number %>
(<%= @test_passage.questions.count %>).
<%= content_tag :strong, @test_passage.current_question.body %>
<%= @test_passage.current_question.answers.any? %>
<% if @test_passage.current_question.answers %>
  <%= form_with url: test_passage_path(@test_passage), local: true, method: :put do |f| %>
    <%= f.collection_check_boxes :checked_answer_ids, @test_passage.current_question.answers, :id, :body, include_hidden: true do |b| %>
      <p>
        <% checked = (@test_passage.answer_ids || []).include?(b.object.id) %>
        <%= hidden_field_tag "answer_ids[]", "#{b.object.id}" %>
        <%= b.check_box id: "checked_answer_ids_#{b.object.id}", checked: checked %>
        <%= b.label %>
      </p>
    <% end %>
    <%= hidden_field_tag :id, @answer.id, name: 'answer[id]' unless @answer.new_record? %>
    <%= f.submit "Previous", disabled: @test_passage.current_question.first? %>
    <%= f.submit "Next", disabled: @test_passage.current_question.last? %>
    <%= f.submit "Finish" %>
  <% end %>
<% end %>